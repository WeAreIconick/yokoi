(()=>{var e,t={2:(e,t,o)=>{var n=o(2199),r=o(4664),i=o(5950);e.exports=function(e){return n(e,i,r)}},79:(e,t,o)=>{var n=o(3702),r=o(80),i=o(4739),s=o(8655),a=o(1175);function c(e){var t=-1,o=null==e?0:e.length;for(this.clear();++t<o;){var n=e[t];this.set(n[0],n[1])}}c.prototype.clear=n,c.prototype.delete=r,c.prototype.get=i,c.prototype.has=s,c.prototype.set=a,e.exports=c},80:(e,t,o)=>{var n=o(6025),r=Array.prototype.splice;e.exports=function(e){var t=this.__data__,o=n(t,e);return!(o<0||(o==t.length-1?t.pop():r.call(t,o,1),--this.size,0))}},270:(e,t,o)=>{var n=o(7068),r=o(346);e.exports=function e(t,o,i,s,a){return t===o||(null==t||null==o||!r(t)&&!r(o)?t!=t&&o!=o:n(t,o,i,s,e,a))}},289:(e,t,o)=>{var n=o(2651);e.exports=function(e){return n(this,e).get(e)}},294:e=>{e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},317:e=>{e.exports=function(e){var t=-1,o=Array(e.size);return e.forEach(function(e,n){o[++t]=[n,e]}),o}},346:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},361:e=>{var t=/^(?:0|[1-9]\d*)$/;e.exports=function(e,o){var n=typeof e;return!!(o=null==o?9007199254740991:o)&&("number"==n||"symbol"!=n&&t.test(e))&&e>-1&&e%1==0&&e<o}},392:e=>{e.exports=function(e,t){return null==e?void 0:e[t]}},659:(e,t,o)=>{var n=o(1873),r=Object.prototype,i=r.hasOwnProperty,s=r.toString,a=n?n.toStringTag:void 0;e.exports=function(e){var t=i.call(e,a),o=e[a];try{e[a]=void 0;var n=!0}catch(e){}var r=s.call(e);return n&&(t?e[a]=o:delete e[a]),r}},689:(e,t,o)=>{var n=o(2),r=Object.prototype.hasOwnProperty;e.exports=function(e,t,o,i,s,a){var c=1&o,l=n(e),u=l.length;if(u!=n(t).length&&!c)return!1;for(var d=u;d--;){var p=l[d];if(!(c?p in t:r.call(t,p)))return!1}var h=a.get(e),f=a.get(t);if(h&&f)return h==t&&f==e;var g=!0;a.set(e,t),a.set(t,e);for(var b=c;++d<u;){var y=e[p=l[d]],v=t[p];if(i)var _=c?i(v,y,p,t,e,a):i(y,v,p,e,t,a);if(!(void 0===_?y===v||s(y,v,o,i,a):_)){g=!1;break}b||(b="constructor"==p)}if(g&&!b){var k=e.constructor,w=t.constructor;k==w||!("constructor"in e)||!("constructor"in t)||"function"==typeof k&&k instanceof k&&"function"==typeof w&&w instanceof w||(g=!1)}return a.delete(e),a.delete(t),g}},695:(e,t,o)=>{var n=o(8096),r=o(2428),i=o(6449),s=o(3656),a=o(361),c=o(7167),l=Object.prototype.hasOwnProperty;e.exports=function(e,t){var o=i(e),u=!o&&r(e),d=!o&&!u&&s(e),p=!o&&!u&&!d&&c(e),h=o||u||d||p,f=h?n(e.length,String):[],g=f.length;for(var b in e)!t&&!l.call(e,b)||h&&("length"==b||d&&("offset"==b||"parent"==b)||p&&("buffer"==b||"byteLength"==b||"byteOffset"==b)||a(b,g))||f.push(b);return f}},938:e=>{e.exports=function(e){var t=this.__data__,o=t.delete(e);return this.size=t.size,o}},945:(e,t,o)=>{var n=o(79),r=o(8223),i=o(3661);e.exports=function(e,t){var o=this.__data__;if(o instanceof n){var s=o.__data__;if(!r||s.length<199)return s.push([e,t]),this.size=++o.size,this;o=this.__data__=new i(s)}return o.set(e,t),this.size=o.size,this}},1042:(e,t,o)=>{var n=o(6110)(Object,"create");e.exports=n},1175:(e,t,o)=>{var n=o(6025);e.exports=function(e,t){var o=this.__data__,r=n(o,e);return r<0?(++this.size,o.push([e,t])):o[r][1]=t,this}},1380:e=>{e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},1420:(e,t,o)=>{var n=o(79);e.exports=function(){this.__data__=new n,this.size=0}},1459:e=>{e.exports=function(e){return this.__data__.has(e)}},1549:(e,t,o)=>{var n=o(2032),r=o(3862),i=o(6721),s=o(2749),a=o(5749);function c(e){var t=-1,o=null==e?0:e.length;for(this.clear();++t<o;){var n=e[t];this.set(n[0],n[1])}}c.prototype.clear=n,c.prototype.delete=r,c.prototype.get=i,c.prototype.has=s,c.prototype.set=a,e.exports=c},1873:(e,t,o)=>{var n=o(9325).Symbol;e.exports=n},1882:(e,t,o)=>{var n=o(2552),r=o(3805);e.exports=function(e){if(!r(e))return!1;var t=n(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},1986:(e,t,o)=>{var n=o(1873),r=o(7828),i=o(5288),s=o(5911),a=o(317),c=o(4247),l=n?n.prototype:void 0,u=l?l.valueOf:void 0;e.exports=function(e,t,o,n,l,d,p){switch(o){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!d(new r(e),new r(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return i(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var h=a;case"[object Set]":var f=1&n;if(h||(h=c),e.size!=t.size&&!f)return!1;var g=p.get(e);if(g)return g==t;n|=2,p.set(e,t);var b=s(h(e),h(t),n,l,d,p);return p.delete(e),b;case"[object Symbol]":if(u)return u.call(e)==u.call(t)}return!1}},2032:(e,t,o)=>{var n=o(1042);e.exports=function(){this.__data__=n?n(null):{},this.size=0}},2199:(e,t,o)=>{var n=o(4528),r=o(6449);e.exports=function(e,t,o){var i=t(e);return r(e)?i:n(i,o(e))}},2404:(e,t,o)=>{var n=o(270);e.exports=function(e,t){return n(e,t)}},2428:(e,t,o)=>{var n=o(7534),r=o(346),i=Object.prototype,s=i.hasOwnProperty,a=i.propertyIsEnumerable,c=n(function(){return arguments}())?n:function(e){return r(e)&&s.call(e,"callee")&&!a.call(e,"callee")};e.exports=c},2552:(e,t,o)=>{var n=o(1873),r=o(659),i=o(9350),s=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":s&&s in Object(e)?r(e):i(e)}},2651:(e,t,o)=>{var n=o(4218);e.exports=function(e,t){var o=e.__data__;return n(t)?o["string"==typeof t?"string":"hash"]:o.map}},2749:(e,t,o)=>{var n=o(1042),r=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return n?void 0!==t[e]:r.call(t,e)}},2804:(e,t,o)=>{var n=o(6110)(o(9325),"Promise");e.exports=n},2949:(e,t,o)=>{var n=o(2651);e.exports=function(e,t){var o=n(this,e),r=o.size;return o.set(e,t),this.size+=o.size==r?0:1,this}},3040:(e,t,o)=>{var n=o(1549),r=o(79),i=o(8223);e.exports=function(){this.size=0,this.__data__={hash:new n,map:new(i||r),string:new n}}},3345:e=>{e.exports=function(){return[]}},3605:e=>{e.exports=function(e){return this.__data__.get(e)}},3650:(e,t,o)=>{var n=o(4335)(Object.keys,Object);e.exports=n},3656:(e,t,o)=>{e=o.nmd(e);var n=o(9325),r=o(9935),i=t&&!t.nodeType&&t,s=i&&e&&!e.nodeType&&e,a=s&&s.exports===i?n.Buffer:void 0,c=(a?a.isBuffer:void 0)||r;e.exports=c},3661:(e,t,o)=>{var n=o(3040),r=o(7670),i=o(289),s=o(4509),a=o(2949);function c(e){var t=-1,o=null==e?0:e.length;for(this.clear();++t<o;){var n=e[t];this.set(n[0],n[1])}}c.prototype.clear=n,c.prototype.delete=r,c.prototype.get=i,c.prototype.has=s,c.prototype.set=a,e.exports=c},3702:e=>{e.exports=function(){this.__data__=[],this.size=0}},3805:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},3862:e=>{e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},4218:e=>{e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},4247:e=>{e.exports=function(e){var t=-1,o=Array(e.size);return e.forEach(function(e){o[++t]=e}),o}},4248:e=>{e.exports=function(e,t){for(var o=-1,n=null==e?0:e.length;++o<n;)if(t(e[o],o,e))return!0;return!1}},4335:e=>{e.exports=function(e,t){return function(o){return e(t(o))}}},4509:(e,t,o)=>{var n=o(2651);e.exports=function(e){return n(this,e).has(e)}},4528:e=>{e.exports=function(e,t){for(var o=-1,n=t.length,r=e.length;++o<n;)e[r+o]=t[o];return e}},4664:(e,t,o)=>{var n=o(9770),r=o(3345),i=Object.prototype.propertyIsEnumerable,s=Object.getOwnPropertySymbols,a=s?function(e){return null==e?[]:(e=Object(e),n(s(e),function(t){return i.call(e,t)}))}:r;e.exports=a},4739:(e,t,o)=>{var n=o(6025);e.exports=function(e){var t=this.__data__,o=n(t,e);return o<0?void 0:t[o][1]}},4840:(e,t,o)=>{var n="object"==typeof o.g&&o.g&&o.g.Object===Object&&o.g;e.exports=n},4894:(e,t,o)=>{var n=o(1882),r=o(294);e.exports=function(e){return null!=e&&r(e.length)&&!n(e)}},4901:(e,t,o)=>{var n=o(2552),r=o(294),i=o(346),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,e.exports=function(e){return i(e)&&r(e.length)&&!!s[n(e)]}},5083:(e,t,o)=>{var n=o(1882),r=o(7296),i=o(3805),s=o(7473),a=/^\[object .+?Constructor\]$/,c=Function.prototype,l=Object.prototype,u=c.toString,d=l.hasOwnProperty,p=RegExp("^"+u.call(d).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!i(e)||r(e))&&(n(e)?p:a).test(s(e))}},5288:e=>{e.exports=function(e,t){return e===t||e!=e&&t!=t}},5481:(e,t,o)=>{var n=o(9325)["__core-js_shared__"];e.exports=n},5527:e=>{var t=Object.prototype;e.exports=function(e){var o=e&&e.constructor;return e===("function"==typeof o&&o.prototype||t)}},5580:(e,t,o)=>{var n=o(6110)(o(9325),"DataView");e.exports=n},5749:(e,t,o)=>{var n=o(1042);e.exports=function(e,t){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=n&&void 0===t?"__lodash_hash_undefined__":t,this}},5861:(e,t,o)=>{var n=o(5580),r=o(8223),i=o(2804),s=o(6545),a=o(8303),c=o(2552),l=o(7473),u="[object Map]",d="[object Promise]",p="[object Set]",h="[object WeakMap]",f="[object DataView]",g=l(n),b=l(r),y=l(i),v=l(s),_=l(a),k=c;(n&&k(new n(new ArrayBuffer(1)))!=f||r&&k(new r)!=u||i&&k(i.resolve())!=d||s&&k(new s)!=p||a&&k(new a)!=h)&&(k=function(e){var t=c(e),o="[object Object]"==t?e.constructor:void 0,n=o?l(o):"";if(n)switch(n){case g:return f;case b:return u;case y:return d;case v:return p;case _:return h}return t}),e.exports=k},5911:(e,t,o)=>{var n=o(8859),r=o(4248),i=o(9219);e.exports=function(e,t,o,s,a,c){var l=1&o,u=e.length,d=t.length;if(u!=d&&!(l&&d>u))return!1;var p=c.get(e),h=c.get(t);if(p&&h)return p==t&&h==e;var f=-1,g=!0,b=2&o?new n:void 0;for(c.set(e,t),c.set(t,e);++f<u;){var y=e[f],v=t[f];if(s)var _=l?s(v,y,f,t,e,c):s(y,v,f,e,t,c);if(void 0!==_){if(_)continue;g=!1;break}if(b){if(!r(t,function(e,t){if(!i(b,t)&&(y===e||a(y,e,o,s,c)))return b.push(t)})){g=!1;break}}else if(y!==v&&!a(y,v,o,s,c)){g=!1;break}}return c.delete(e),c.delete(t),g}},5950:(e,t,o)=>{var n=o(695),r=o(8984),i=o(4894);e.exports=function(e){return i(e)?n(e):r(e)}},6009:(e,t,o)=>{e=o.nmd(e);var n=o(4840),r=t&&!t.nodeType&&t,i=r&&e&&!e.nodeType&&e,s=i&&i.exports===r&&n.process,a=function(){try{return i&&i.require&&i.require("util").types||s&&s.binding&&s.binding("util")}catch(e){}}();e.exports=a},6025:(e,t,o)=>{var n=o(5288);e.exports=function(e,t){for(var o=e.length;o--;)if(n(e[o][0],t))return o;return-1}},6110:(e,t,o)=>{var n=o(5083),r=o(392);e.exports=function(e,t){var o=r(e,t);return n(o)?o:void 0}},6449:e=>{var t=Array.isArray;e.exports=t},6545:(e,t,o)=>{var n=o(6110)(o(9325),"Set");e.exports=n},6721:(e,t,o)=>{var n=o(1042),r=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(n){var o=t[e];return"__lodash_hash_undefined__"===o?void 0:o}return r.call(t,e)?t[e]:void 0}},7068:(e,t,o)=>{var n=o(7217),r=o(5911),i=o(1986),s=o(689),a=o(5861),c=o(6449),l=o(3656),u=o(7167),d="[object Arguments]",p="[object Array]",h="[object Object]",f=Object.prototype.hasOwnProperty;e.exports=function(e,t,o,g,b,y){var v=c(e),_=c(t),k=v?p:a(e),w=_?p:a(t),m=(k=k==d?h:k)==h,x=(w=w==d?h:w)==h,j=k==w;if(j&&l(e)){if(!l(t))return!1;v=!0,m=!1}if(j&&!m)return y||(y=new n),v||u(e)?r(e,t,o,g,b,y):i(e,t,k,o,g,b,y);if(!(1&o)){var S=m&&f.call(e,"__wrapped__"),E=x&&f.call(t,"__wrapped__");if(S||E){var O=S?e.value():e,C=E?t.value():t;return y||(y=new n),b(O,C,o,g,y)}}return!!j&&(y||(y=new n),s(e,t,o,g,b,y))}},7167:(e,t,o)=>{var n=o(4901),r=o(7301),i=o(6009),s=i&&i.isTypedArray,a=s?r(s):n;e.exports=a},7217:(e,t,o)=>{var n=o(79),r=o(1420),i=o(938),s=o(3605),a=o(9817),c=o(945);function l(e){var t=this.__data__=new n(e);this.size=t.size}l.prototype.clear=r,l.prototype.delete=i,l.prototype.get=s,l.prototype.has=a,l.prototype.set=c,e.exports=l},7296:(e,t,o)=>{var n,r=o(5481),i=(n=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";e.exports=function(e){return!!i&&i in e}},7301:e=>{e.exports=function(e){return function(t){return e(t)}}},7473:e=>{var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},7534:(e,t,o)=>{var n=o(2552),r=o(346);e.exports=function(e){return r(e)&&"[object Arguments]"==n(e)}},7670:(e,t,o)=>{var n=o(2651);e.exports=function(e){var t=n(this,e).delete(e);return this.size-=t?1:0,t}},7828:(e,t,o)=>{var n=o(9325).Uint8Array;e.exports=n},8096:e=>{e.exports=function(e,t){for(var o=-1,n=Array(e);++o<e;)n[o]=t(o);return n}},8223:(e,t,o)=>{var n=o(6110)(o(9325),"Map");e.exports=n},8303:(e,t,o)=>{var n=o(6110)(o(9325),"WeakMap");e.exports=n},8655:(e,t,o)=>{var n=o(6025);e.exports=function(e){return n(this.__data__,e)>-1}},8859:(e,t,o)=>{var n=o(3661),r=o(1380),i=o(1459);function s(e){var t=-1,o=null==e?0:e.length;for(this.__data__=new n;++t<o;)this.add(e[t])}s.prototype.add=s.prototype.push=r,s.prototype.has=i,e.exports=s},8984:(e,t,o)=>{var n=o(5527),r=o(3650),i=Object.prototype.hasOwnProperty;e.exports=function(e){if(!n(e))return r(e);var t=[];for(var o in Object(e))i.call(e,o)&&"constructor"!=o&&t.push(o);return t}},9219:e=>{e.exports=function(e,t){return e.has(t)}},9325:(e,t,o)=>{var n=o(4840),r="object"==typeof self&&self&&self.Object===Object&&self,i=n||r||Function("return this")();e.exports=i},9350:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},9417:(e,t,o)=>{"use strict";const n=window.wp.plugins,r=window.wp.components,i=window.wp.apiFetch;var s=o.n(i);const a=window.wp.i18n,c=window.wp.element,l=window.wp.data,u=window.wp.domReady;var d=o.n(u);const p=window.wp.url;var h=o(2404),f=o.n(h);const g=window.ReactJSXRuntime,b=window.wp.primitives;var y=(0,g.jsx)(b.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,g.jsx)(b.Path,{d:"m11.3 17.2-5-5c-.1-.1-.1-.3 0-.4l2.3-2.3-1.1-1-2.3 2.3c-.7.7-.7 1.8 0 2.5l5 5H7.5v1.5h5.3v-5.2h-1.5v2.6zm7.5-6.4-5-5h2.7V4.2h-5.2v5.2h1.5V6.8l5 5c.1.1.1.3 0 .4l-2.3 2.3 1.1 1.1 2.3-2.3c.6-.7.6-1.9-.1-2.5z"})}),v=(0,g.jsx)(b.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,g.jsx)(b.Path,{d:"M11.776 4.454a.25.25 0 01.448 0l2.069 4.192a.25.25 0 00.188.137l4.626.672a.25.25 0 01.139.426l-3.348 3.263a.25.25 0 00-.072.222l.79 4.607a.25.25 0 01-.362.263l-4.138-2.175a.25.25 0 00-.232 0l-4.138 2.175a.25.25 0 01-.363-.263l.79-4.607a.25.25 0 00-.071-.222L4.754 9.881a.25.25 0 01.139-.426l4.626-.672a.25.25 0 00.188-.137l2.069-4.192z"})}),_=(0,g.jsx)(b.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,g.jsx)(b.Path,{fillRule:"evenodd",d:"M9.706 8.646a.25.25 0 01-.188.137l-4.626.672a.25.25 0 00-.139.427l3.348 3.262a.25.25 0 01.072.222l-.79 4.607a.25.25 0 00.362.264l4.138-2.176a.25.25 0 01.233 0l4.137 2.175a.25.25 0 00.363-.263l-.79-4.607a.25.25 0 01.072-.222l3.347-3.262a.25.25 0 00-.139-.427l-4.626-.672a.25.25 0 01-.188-.137l-2.069-4.192a.25.25 0 00-.448 0L9.706 8.646zM12 7.39l-.948 1.921a1.75 1.75 0 01-1.317.957l-2.12.308 1.534 1.495c.412.402.6.982.503 1.55l-.362 2.11 1.896-.997a1.75 1.75 0 011.629 0l1.895.997-.362-2.11a1.75 1.75 0 01.504-1.55l1.533-1.495-2.12-.308a1.75 1.75 0 01-1.317-.957L12 7.39z",clipRule:"evenodd"})});const k=({error:e=null,searchValue:t="",onSearchChange:o=()=>{},searchHistory:n=[],blocksEnabled:i={},blockDefinitions:s={},onToggle:c,onToggleAll:l=null,onToggleFavorite:u=null,favoriteBlocks:d=new Set,togglingBlocks:p=new Set,hasMore:h=!1,onLoadMore:f=()=>{},onRetry:b=null,blockStatistics:k={},validationErrors:w={},disabled:m=!1,onRefreshInserter:x=null})=>{var j;const S=(Object.keys(s).length?Object.keys(s):Object.keys(i)).map(e=>{var t;return[e,null===(t=i?.[e])||void 0===t||t]}),E=null!==(j=t?.toLowerCase?.())&&void 0!==j?j:"",O=[...S].sort(([e],[t])=>{const o=d.has(e),n=d.has(t);if(o&&!n)return-1;if(!o&&n)return 1;const r=s[e]?.title||e,i=s[t]?.title||t;return r.localeCompare(i)}).filter(([e])=>!E||`${s[e]?.title||e} ${s[e]?.description||""}`.toLowerCase().includes(E)),C=O.filter(([,e])=>e).length,R=O.length,T=R>0&&C===R,I=R>0&&0===C;return(0,g.jsx)(r.Card,{children:(0,g.jsx)(r.CardBody,{children:(0,g.jsxs)(r.Flex,{direction:"column",gap:4,children:[(0,g.jsx)(r.Notice,{status:"info",isDismissible:!1,className:"yokoi-block-toggle-notice",children:(0,a.__)('Changes are saved immediately. If a block doesn\'t appear or disappear in the inserter right away, click "Refresh Inserter" below or close and reopen the block inserter.',"yokoi")}),(0,g.jsx)(r.Button,{variant:"secondary",size:"small",icon:y,onClick:x||(()=>{}),disabled:m||!x,children:(0,a.__)("Refresh Block Inserter","yokoi")}),(0,g.jsxs)(r.Flex,{direction:"column",gap:2,children:[(0,g.jsx)(r.SearchControl,{value:t,onChange:o,placeholder:(0,a.__)("Search blocks… (⌘K)","yokoi"),disabled:m,__nextHasNoMarginBottom:!0,"aria-label":(0,a.__)("Search blocks","yokoi"),"aria-describedby":"yokoi-search-description"}),(0,g.jsx)("span",{id:"yokoi-search-description",className:"screen-reader-text",children:(0,a.__)("Search for blocks by name or description. Use arrow keys to navigate results.","yokoi")}),n.length>0&&!t&&(0,g.jsx)(r.Flex,{gap:1,wrap:!0,children:n.slice(0,5).map(e=>(0,g.jsx)(r.Button,{variant:"tertiary",size:"small",onClick:()=>o(e),children:e},e))})]}),l&&R>0&&(0,g.jsxs)(r.Flex,{gap:2,children:[(0,g.jsx)(r.Button,{variant:"secondary",size:"small",onClick:()=>l(!0),disabled:m||T,children:(0,a.__)("Enable All","yokoi")}),(0,g.jsx)(r.Button,{variant:"secondary",size:"small",onClick:()=>l(!1),disabled:m||I,children:(0,a.__)("Disable All","yokoi")}),R>0&&(0,g.jsxs)("span",{style:{marginLeft:"auto",fontSize:"12px",color:"#757575"},children:[C," / ",R," ",(0,a.__)("enabled","yokoi")]})]}),e&&(0,g.jsx)(r.Notice,{status:"error",isDismissible:!1,actions:b?[{label:(0,a.__)("Retry","yokoi"),onClick:b}]:[],children:e?.message||(0,a.__)("Unable to load block catalog.","yokoi")}),0===S.length&&(0,g.jsx)("p",{children:(0,a.__)("No blocks registered yet. Blocks will appear here once available.","yokoi")}),0===O.length&&S.length>0&&(0,g.jsx)("p",{children:(0,a.__)("No blocks match your search.","yokoi")}),O.map(([e,t])=>{const o=({blockName:e,enabled:t})=>{const o=s[e]?.title||e,n=s[e]?.description,i=p.has(e),l=d.has(e),h=k[e]||{},f=h.usage_count||0,b=h.post_count||0;return(0,g.jsxs)(r.Flex,{align:"flex-start",gap:2,style:{position:"relative"},children:[(0,g.jsxs)(r.Flex,{direction:"column",gap:0,style:{flex:1,minWidth:0},children:[(0,g.jsxs)(r.Flex,{align:"center",justify:"space-between",gap:2,children:[(0,g.jsx)(r.ToggleControl,{label:o,checked:Boolean(t),onChange:()=>c(e),help:n,__nextHasNoMarginBottom:!0,disabled:m||i,"aria-describedby":`yokoi-block-${e}-description`,"aria-invalid":w[e]?"true":void 0,"aria-errormessage":w[e]?`yokoi-error-${e}`:void 0}),u&&(0,g.jsx)(r.Button,{icon:l?v:_,onClick:()=>u(e),variant:"tertiary",size:"small",style:{minWidth:"24px",width:"24px",height:"24px",padding:0,flexShrink:0,display:"flex",alignItems:"center",justifyContent:"center"},"aria-label":l?(0,a.__)("Remove from favorites","yokoi"):(0,a.__)("Add to favorites","yokoi")})]}),w[e]&&(0,g.jsx)("span",{id:`yokoi-error-${e}`,role:"alert",style:{fontSize:"12px",color:"#d63638",marginLeft:"48px",marginTop:"-4px"},children:w[e]}),(0,g.jsxs)(r.Flex,{gap:2,style:{marginTop:"-8px",marginLeft:"48px",fontSize:"11px",color:"#757575"},children:[f>0&&(0,g.jsxs)("span",{id:`yokoi-block-${e}-stats`,"aria-label":(0,a.__)("Usage statistics","yokoi"),children:[f," ",(0,a.__)("uses","yokoi")]}),b>0&&(0,g.jsxs)("span",{"aria-label":(0,a.__)("Post count","yokoi"),children:[b," ",(0,a.__)("posts","yokoi")]})]})]}),i&&(0,g.jsx)(r.Spinner,{size:16,"aria-label":(0,a.__)("Saving…","yokoi")})]},e)};return(0,g.jsx)(o,{blockName:e,enabled:t},e)}),h&&(0,g.jsx)(r.Button,{variant:"secondary",onClick:f,disabled:m,children:(0,a.__)("Load more blocks","yokoi")})]})})})};class w{constructor(e={}){this.queue=new Map,this.processing=!1,this.debounceDelay=e.debounceDelay||300,this.maxBatchSize=e.maxBatchSize||50,this.timeoutId=null,this.processCallback=null,this.onComplete=null}setProcessCallback(e){this.processCallback=e}setOnComplete(e){this.onComplete=e}enqueue(e,t){this.queue.set(e,t),this.timeoutId&&clearTimeout(this.timeoutId),this.queue.size>=this.maxBatchSize?this.process():this.timeoutId=setTimeout(()=>{this.process()},this.debounceDelay)}async process(){if(!this.processing&&0!==this.queue.size){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null),this.processing=!0;try{const e=new Map(this.queue);this.queue.clear();const t={};e.forEach((e,o)=>{t[o]=e}),this.processCallback&&await this.processCallback(t),this.onComplete&&this.onComplete(t)}catch(e){}finally{this.processing=!1,this.queue.size>0&&(this.timeoutId=setTimeout(()=>{this.process()},this.debounceDelay))}}}getQueueSize(){return this.queue.size}isProcessing(){return this.processing}clear(){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null),this.queue.clear(),this.processing=!1}getPendingUpdates(){const e={};return this.queue.forEach((t,o)=>{e[o]=t}),e}}window.wp.blocks;const m=new Map,x=new Map;function j(e){return e&&e.blocks_enabled?Object.entries(e.blocks_enabled).filter(([,e])=>!e).map(([e])=>e):[]}function S(e){return e&&e.blocks_enabled?Object.entries(e.blocks_enabled).filter(([,e])=>e).map(([e])=>e):[]}function E(e=!1){return new Promise(t=>{try{const o=(0,l.dispatch)("core/block-editor");o&&"function"==typeof o.invalidateResolution&&(o.invalidateResolution("getInserterItems"),o.invalidateResolution("__experimentalGetInserterItems"),o.invalidateResolution("getAllowedBlocks"));const n=(0,l.dispatch)("core/editor");n&&"function"==typeof n.invalidateResolution&&(n.invalidateResolution("getInserterItems"),n.invalidateResolution("__experimentalGetInserterItems"));try{const e=(0,l.dispatch)("core/blocks");e&&"function"==typeof e.invalidateResolution&&e.invalidateResolution("getBlockTypes")}catch(e){}if(window.dispatchEvent(new CustomEvent("yokoi:blocks-updated")),window?.wp?.data?.select){const{select:e}=window.wp.data;try{const t=e("core/block-editor");t&&("function"==typeof t.getInserterItems&&(t.getInserterItems(),setTimeout(()=>t.getInserterItems(),100)),"function"==typeof t.__experimentalGetInserterItems&&(t.__experimentalGetInserterItems(),setTimeout(()=>t.__experimentalGetInserterItems(),100)))}catch(e){}}setTimeout(()=>{try{const o=document.querySelector('button[aria-label*="Add block"], button[aria-label*="Toggle block inserter"], button[aria-label*="Inserter"], .block-editor-inserter__toggle, [data-tooltip*="Add block"], button[aria-expanded="true"][aria-label*="block"]');if(o){const n=document.querySelector(".block-editor-inserter__panel, .block-editor-inserter__menu, .block-editor-inserter__main-area, .block-editor-inserter__sidebar"),r=n&&"none"!==n.style.display&&!n.classList.contains("is-hidden")&&null!==n.offsetParent;e||r?(o.click(),setTimeout(()=>{o.click(),setTimeout(()=>{if(window?.wp?.data?.select){const{select:e}=window.wp.data,t=e("core/block-editor");t&&"function"==typeof t.getInserterItems&&t.getInserterItems()}t(!0)},100)},200)):(o.click(),setTimeout(()=>{o.click(),t(!0)},300))}else setTimeout(()=>{window.dispatchEvent(new Event("resize")),t(!0)},100)}catch(e){t(!1)}},200)}catch(e){t(!1)}})}const O=window.yokoiSettings||{},C=Array.isArray(O.blocks)?O.blocks:[],R="yokoi-settings-sidebar",T=(e=[])=>e.reduce((e,t)=>(t?.name&&(e[t.name]=t),e),{}),I=(e={})=>({blocks_enabled:Object.fromEntries(Object.keys(e).map(e=>[e,!0])),default_configs:{},visibility_controls:{},date_now_api_key:""}),P=(e,t)=>{const o=I(t),n={...o,...e||{}};return n.blocks_enabled={...o.blocks_enabled,...e?.blocks_enabled||{}},Object.keys(t).forEach(e=>{"boolean"!=typeof n.blocks_enabled[e]&&(n.blocks_enabled[e]=Boolean(o.blocks_enabled[e]))}),n.default_configs={...o.default_configs,...e?.default_configs||{}},n.visibility_controls={...o.visibility_controls,...e?.visibility_controls||{}},n.date_now_api_key="string"==typeof e?.date_now_api_key?e.date_now_api_key:o.date_now_api_key,n},D=e=>{"undefined"!=typeof window&&(window.yokoiSettings={...window.yokoiSettings||{},settings:e},window.dispatchEvent(new CustomEvent("yokoi:settings-updated",{detail:e})))};O?.nonce&&s().use(s().createNonceMiddleware(O.nonce));let z=null,A=null;const B=(e={})=>(0,g.jsxs)("svg",{className:"yokoi-sidebar__icon",width:"20",height:"20",viewBox:"0 0 163.3 163.3",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",...e,children:[(0,g.jsx)("path",{d:"M145.1,38.5c0-1.2-.9-2.1-2.1-2.1H20.3c-1.2,0-2.1.9-2.1,2.1v104.4c0,1.2.9,2.1,2.1,2.1h122.7c1.2,0,2.1-.9,2.1-2.1V38.5ZM0,161.9V1.5C.6.5,1.8,0,3.5,0,51.6,0,98.1,0,143.1,0c1.2,0,2.1.9,2.1,2.1v13.9c0,1.2.9,2.1,2.1,2.2.6,0,5.2,0,13.9,0,1.4,0,2.1.8,2.1,2.4,0,3.5,0,50,0,139.5,0,2.2-.6,3.1-2.8,3.1-53,0-105.9,0-158.9,0,0,0-.2,0-.2,0l-1.4-1.3",fill:"currentColor"}),(0,g.jsx)("path",{d:"M75.2,86.9c0,1.2-.9,2.1-2.1,2.1h-8.8c-1.2,0-2.1-1-2.1-2.1v-18.2c0-1.2,1-2.1,2.1-2.1h8.8c1.2,0,2.1,1,2.1,2.1v18.2Z",fill:"currentColor"}),(0,g.jsx)("path",{d:"M101.1,86.9c0,1.2-.9,2.1-2.1,2.1h-8.8c-1.2,0-2.1-.9-2.1-2.1v-18.2c0-1.2.9-2.1,2.1-2.1h8.8c1.2,0,2.1.9,2.1,2.1v18.2Z",fill:"currentColor"}),(0,g.jsx)("path",{d:"M81.6,101.8c19.6,0,29.5,0,29.7,0,1.1,0,1.9-.9,1.9-2v-8.1c0-1.1.9-2,2-2h9c1.1,0,2,.9,2,2v8.9c0,1.1-.9,2.1-2.1,2.1h-8.2c-1.1,0-1.9.8-1.9,1.9v8.1c0,1.1-.9,1.9-1.9,2,0,0-10.2,0-30.5,0-20.3,0-30.5,0-30.5,0-1.1,0-1.9-1-1.9-2v-8.1c0-1-.9-1.9-2-1.9h-8.2c-1.1,0-2.1-.9-2.1-2.1v-8.9c0-1.1.9-2,2-2h9c1.1,0,2,.9,2,2v8.1c0,1.1.9,1.9,1.9,2,.2,0,10,0,29.7,0Z",fill:"currentColor"})]}),M=()=>{var e,t;if(!z||!A)return null;const[o,n]=(0,c.useState)(()=>T(C)),[i,u]=(0,c.useState)(null),[d,h]=(0,c.useState)(""),[b,y]=(0,c.useState)(""),[v,_]=(0,c.useState)({page:0,totalPages:0,search:""}),[R,M]=(0,c.useState)(new Set),[F,L]=(0,c.useState)(new Set),[N,V]=(0,c.useState)([]),[q,U]=(0,c.useState)([]),[$,G]=(0,c.useState)(-1),[W,K]=(0,c.useState)({}),[H,J]=(0,c.useState)({}),[Y,Z]=(0,c.useState)(null),[Q,X]=(0,c.useState)(!1),ee=(0,c.useRef)(null),te=(0,c.useRef)({}),oe=(0,c.useRef)(null),ne=(0,c.useRef)(new Map),re=(0,c.useRef)(null),ie=(0,c.useRef)(null);ie.current||(ie.current=new w({debounceDelay:300,maxBatchSize:50}));const se=O?.settingsOption||"yokoi_settings",ae=!1!==O?.capabilities?.canManage,ce=O?.blocksEndpoint;(0,c.useEffect)(()=>{ee.current&&ee.current.abort();const e=new AbortController;ee.current=e;const t=setTimeout(()=>{y(d)},300);return()=>{clearTimeout(t),e.abort()}},[d]),(0,c.useEffect)(()=>{try{const e=localStorage.getItem("yokoi_favorites");e&&L(new Set(JSON.parse(e)))}catch(e){}},[]),(0,c.useEffect)(()=>{try{localStorage.setItem("yokoi_favorites",JSON.stringify(Array.from(F)))}catch(e){}},[F]),(0,c.useEffect)(()=>{ce&&(async()=>{try{const e=ce.replace("/blocks","/blocks/statistics"),t=await s()({url:e});if(t&&t.usage){const e={};Object.keys(t.usage).forEach(o=>{e[o]={usage_count:t.usage[o],last_used:t.last_used[o],post_count:t.post_count[o]?t.post_count[o].length:0}}),K(e)}}catch(e){}})()},[ce]),(0,c.useEffect)(()=>{const e=e=>{if((e.metaKey||e.ctrlKey)&&"k"===e.key){e.preventDefault();const t=document.querySelector('input[placeholder*="Search blocks"]');t&&t.focus()}"Escape"===e.key&&d&&h("")};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[d]);const{editEntityRecord:le,receiveEntityRecords:ue,saveEditedEntityRecord:de}=(0,l.useDispatch)("core"),pe=(0,c.useCallback)(()=>{if($>0&&q[$-1]){const e=q[$-1];G(e=>e-1),le("root","option",se,{value:e})}},[$,q,le,se]),he=(0,c.useCallback)(()=>{if($<q.length-1&&q[$+1]){const e=q[$+1];G(e=>e+1),le("root","option",se,{value:e})}},[$,q,le,se]);(0,c.useEffect)(()=>{const e=e=>{!e.metaKey&&!e.ctrlKey||"z"!==e.key||e.shiftKey||(e.preventDefault(),$>0&&pe()),(e.metaKey||e.ctrlKey)&&e.shiftKey&&"Z"===e.key&&(e.preventDefault(),$<q.length-1&&he())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[$,q.length,pe,he]);const{__experimentalResolveSelect:fe,invalidateResolution:ge}=(0,l.useDispatch)("core/data"),be=(0,c.useCallback)(({invalidate:e=!1}={})=>{if(!fe)return Promise.resolve();const t=["root","option",se];return e&&ge&&ge("core","getEntityRecord",t),fe("core","getEntityRecord",t).catch(e=>{logDebug("Failed to resolve entity config",e)})},[fe,se,ge]),{addEntities:ye,receiveEntityRecords:ve,receiveEntityConfig:_e}=(0,l.useDispatch)("core"),ke=(0,c.useRef)(!1),we=(0,c.useRef)(!1),me=(0,c.useRef)(null),xe=(0,c.useRef)([]),{optionValue:je,persistedOptionValue:Se,optionDirty:Ee,optionResolving:Oe,optionSaving:Ce,entityConfig:Re,hasEntityConfigSelector:Te}=(0,l.useSelect)(e=>{const t=e("core"),o=t.getEntityRecord("root","option",se),n=t.getEditedEntityRecord?t.getEditedEntityRecord("root","option",se):null;return{optionValue:n&&Object.prototype.hasOwnProperty.call(n,"value")?n.value:o?.value,persistedOptionValue:o?.value,optionDirty:!!t.hasEditsForEntityRecord&&t.hasEditsForEntityRecord("root","option",se),optionResolving:!!t.isResolving&&t.isResolving("getEntityRecord",["root","option",se]),optionSaving:!!t.isSavingEntityRecord&&t.isSavingEntityRecord("root","option",se),entityConfig:t.getEntityConfig?t.getEntityConfig("root","option",se):null,hasEntityConfigSelector:"function"==typeof t.getEntityConfig}},[se]),Ie=void 0!==je||void 0!==Se,Pe=void 0!==je?je:void 0!==Se?Se:null!==(e=O.settings)&&void 0!==e?e:I(o),De=(0,c.useMemo)(()=>P(Pe,o),[Pe,o]),ze=(0,c.useRef)(!1),Ae=(0,c.useRef)(!1),Be=Te,Me=!Be||Boolean(Re),Fe=(0,c.useCallback)((e,t=0)=>{const o=t+1,n=Math.min(5e3,1e3*o);window.setTimeout(()=>{try{le("root","option",se,{value:e}),logDebug("Delayed seed succeeded",{attempt:o}),me.current=null}catch(t){logDebug("Delayed seed attempt failed",t,{attempt:o}),o<5&&Fe(e,o)}},n)},[le,se]);(0,c.useEffect)(()=>{if(!Be)return void logDebug("Entity config selector unavailable; assuming ready state");if(Me)return;var e;logDebug("Resolving entity config for option",se),ye&&_e&&!ke.current&&(_e("root","option",se,{name:se,kind:"root",label:se,rest_base:se}),ye([{name:se,kind:"root",baseURL:"/wp/v2/settings",key:se,plural:se,label:se}]),ke.current=!0),ve&&ve("root","option",[{id:se,name:se,value:null!==(e=O.settings)&&void 0!==e?e:{}}],{name:se}),be({invalidate:!0}),we.current||(we.current=!0,logDebug("Priming WP settings endpoint"),s()({path:"/wp/v2/settings",method:"GET"}).catch(e=>{logDebug("Failed to prime settings endpoint",e)}));const t=window.setTimeout(()=>{Me||(logDebug("Retrying entity config resolution for option",se),be({invalidate:!0}))},1e3);return()=>window.clearTimeout(t)},[Me,se,ye,be,ve,Be]),(0,c.useEffect)(()=>{if(Me){if(me.current){const e=me.current;me.current=null;try{le("root","option",se,{value:e}),de&&de("root","option",se).catch(()=>{}),logDebug("Pending seed applied after entity ready")}catch(t){logDebug("Pending seed failed after entity ready; retrying",t),Fe(e)}}if(xe.current.length>0){const e=[...xe.current];xe.current=[],e.forEach(e=>{try{le("root","option",se,{value:e}),de&&de("root","option",se).catch(()=>{}),logDebug("Queued update applied after entity ready")}catch(t){logDebug("Queued update failed, re-queuing",t),xe.current.push(e)}})}}},[Me,le,de,se,Fe]),(0,c.useEffect)(()=>{if(!Be&&!Ie&&Object.keys(o).length>0&&!Ae.current){var e;const t=P(null!==(e=O.settings)&&void 0!==e?e:I(o),o);logDebug("Seeding fallback option (no entity selector available)",t),Ae.current=!0,ue&&ue("root","option",[{id:se,name:se,value:t}],{name:se})}},[Be,Ie,o,O.settings,se,ue]),(0,c.useEffect)(()=>{logDebug("Option status",{optionValue:je,persistedOptionValue:Se,hasFetchedOption:Ie})},[je,Se,Ie]),(0,c.useEffect)(()=>{if(Me||logDebug("Entity config not ready; proceeding with fallback seeding"),!Ie&&!Ae.current&&Object.keys(o).length>0){var e;const t=P(null!==(e=O.settings)&&void 0!==e?e:I(o),o);return logDebug("Seeding fallback option value",t),Ae.current=!0,void(Me?le("root","option",se,{value:t}):ue&&(logDebug("Entity config missing; seeding via receiveEntityRecords"),me.current=t,ue("root","option",[{id:se,name:se,value:t}],{name:se}),Fe(t)))}if(!ze.current&&void 0===je&&void 0!==Se){const e=P(Se,o);return logDebug("Seeding edited option with persisted value"),ze.current=!0,void le("root","option",se,{value:e})}Me&&void 0!==je&&!f()(je,De)&&(logDebug("Syncing edited option to normalized snapshot"),le("root","option",se,{value:De}))},[je,Se,De,se,le,ue,o,Me,Fe]),(0,c.useEffect)(()=>{D(De)},[De]);const Le=Ie,Ne=De.blocks_enabled||{},Ve=Y||Ne,qe=De.date_now_api_key||"";(0,c.useEffect)(()=>{De?.blocks_enabled&&Z(De.blocks_enabled)},[De]);const Ue=(0,c.useCallback)(e=>{const t=De||I(o),n={...t,blocks_enabled:{...t.blocks_enabled||{},...te.current}},r=P(e(n),o);try{le("root","option",se,{value:r})}catch(e){logDebug("applySettingsChange: error editing entity record",e)}const i=Date.now();re.current=i;let a=O?.restEndpoint||"yokoi/v1/settings";a.startsWith("http")?a=new URL(a).pathname.replace("/wp-json/",""):a.startsWith("/")&&(a=a.substring(1)),s()({path:a,method:"POST",data:{blocks_enabled:r.blocks_enabled,default_configs:r.default_configs,visibility_controls:r.visibility_controls,date_now_api_key:r.date_now_api_key,nonce:O?.settingsNonce||O?.nonce||""},headers:{"X-WP-Nonce":O?.nonce||""}}).then(()=>{re.current===i&&(logDebug("Settings saved successfully"),re.current=null,D(r),function(e){if(!window?.wp?.blocks)return;"undefined"!=typeof window&&(window.yokoiSettings={...window.yokoiSettings||{},settings:e});const{getBlockType:t}=window.wp.blocks,o=S(e);j(e),function(){if(!window?.wp?.blocks)return;const{getBlockType:e,getBlockTypes:t}=window.wp.blocks;(t?t():[]).forEach(e=>{e?.name&&e.name.startsWith("yokoi/")&&x.set(e.name,e)})}(),function(e){if(!window?.wp?.blocks)return;const{registerBlockType:t,getBlockType:o}=window.wp.blocks;S(e).forEach(e=>{if(o(e))return void(m.has(e)&&m.delete(e));const n=x.get(e);if(n)try{t(e,n),m.delete(e)}catch(e){}})}(e),function(e){if(!window?.wp?.blocks)return;const{unregisterBlockType:t,getBlockType:o}=window.wp.blocks;j(e).forEach(e=>{const n=o(e);if(n&&!n.render){x.set(e,n);try{t(e),m.set(e,!0)}catch(e){}}})}(e),o.some(e=>{const o=t(e);return o&&o.render})?setTimeout(()=>{E(!0)},300):E()}(r))}).catch(e=>{if(re.current===i&&(re.current=null,logDebug("applySettingsChange: error saving via REST API",e),De))try{le("root","option",se,{value:De})}catch(e){}})},[le,se,De,o,O]),$e=(0,c.useCallback)(async({search:e="",page:t=1,append:o=!1}={})=>{if(!ce)return;const r=`${e}_${t}`;if(ne.current.has(r))return ne.current.get(r);u(null);const i=(async()=>{try{const r={url:(0,p.addQueryArgs)(ce,{per_page:100,page:t,...e?{search:e}:{}}),method:"GET",parse:!1};ee.current&&(r.signal=ee.current.signal);const i=await s()(r),a=await i.json();if(!i.ok)throw a;const c=parseInt(i.headers.get("X-WP-Total"),10)||a.length||0,l=parseInt(i.headers.get("X-WP-TotalPages"),10)||Math.max(1,Math.ceil(c/100)),u=T(Array.isArray(a)?a:[]);let d=u;return n(e=>(d=o?{...e,...u}:u,d)),_({page:t,totalPages:l,search:e}),e&&!N.includes(e)&&V(t=>[e,...t.slice(0,9)]),{success:!0}}catch(t){throw"AbortError"!==t?.name&&(u(t),o||_({page:0,totalPages:0,search:e})),t}finally{ne.current.delete(r)}})();return ne.current.set(r,i),i},[ce,N]);(0,c.useEffect)(()=>{ce&&$e({search:b,page:1,append:!1})},[ce,b,$e]);const Ge=(0,c.useCallback)(e=>{const t={};return e.blocks_enabled&&"object"!=typeof e.blocks_enabled&&(t.blocks_enabled=(0,a.__)("Blocks enabled must be an object.","yokoi")),e.date_now_api_key&&"string"!=typeof e.date_now_api_key&&(t.date_now_api_key=(0,a.__)("API key must be a string.","yokoi")),J(t),0===Object.keys(t).length},[]);(0,c.useEffect)(()=>{const e=ie.current;return e.setProcessCallback(async e=>{const t=De||I(o),n={...t,blocks_enabled:{...t.blocks_enabled||{},...e}};if(!Ge(n))return void Z(Ne);Ue(()=>n);const r=Object.keys(e);setTimeout(()=>{M(e=>{const t=new Set(e);return r.forEach(e=>t.delete(e)),t})},200)}),()=>{e.clear()}},[De,o,Ue,Ge,Ne]);const We=(0,c.useCallback)(e=>{const t=ie.current.getPendingUpdates(),o=!{...Y||Ne,...te.current,...t}[e];Z(n=>({...n||Ne,...te.current,...t,[e]:o})),M(t=>new Set(t).add(e)),ie.current.enqueue(e,o)},[Y,Ne]),Ke=(0,c.useCallback)(e=>{L(t=>{const o=new Set(t);return o.has(e)?o.delete(e):o.add(e),o})},[]),He=(0,c.useCallback)(e=>{const t=Object.keys(o);Z(o=>{const n={...o||Ne};return t.forEach(t=>{n[t]=e}),n}),t.forEach(t=>{M(e=>new Set(e).add(t)),te.current[t]=e}),oe.current&&clearTimeout(oe.current),oe.current=setTimeout(()=>{const e={...te.current},t=Object.keys(e);Ue(t=>{const o={...t,blocks_enabled:{...t.blocks_enabled||{},...e}};return Object.keys(e).forEach(e=>{delete te.current[e]}),o}),setTimeout(()=>{M(e=>{const o=new Set(e);return t.forEach(e=>o.delete(e)),o})},300)},500)},[Ue,o,Ne]),Je=(0,c.useCallback)(e=>{Ue(t=>({...t,date_now_api_key:e}))},[Ue]),Ye=(0,c.useCallback)(()=>{const e=De||I(o),t={version:"1.0",exported:(new Date).toISOString(),settings:{blocks_enabled:e.blocks_enabled,default_configs:e.default_configs,visibility_controls:e.visibility_controls}},n=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),r=URL.createObjectURL(n),i=document.createElement("a");i.href=r,i.download=`yokoi-settings-${(new Date).toISOString().split("T")[0]}.json`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r)},[De,o]),Ze=(0,c.useCallback)(()=>{const e=document.createElement("input");e.type="file",e.accept="application/json",e.onchange=e=>{const t=e.target.files[0];if(!t)return;const o=new FileReader;o.onload=e=>{try{const t=JSON.parse(e.target.result);t.settings&&"1.0"===t.version&&Ue(e=>({...e,blocks_enabled:{...e.blocks_enabled,...t.settings.blocks_enabled||{}},default_configs:{...e.default_configs,...t.settings.default_configs||{}},visibility_controls:{...e.visibility_controls,...t.settings.visibility_controls||{}}}))}catch(e){}},o.readAsText(t)},e.click()},[Ue]),Qe=((0,c.useCallback)(e=>{"all"===e?He(!0):"none"===e?He(!1):"favorites"===e&&Array.from(F).forEach(e=>{Ve[e]||We(e)})},[He,We,F,Ve]),(0,c.useCallback)(async()=>{X(!0);try{await async function(){return E(!0)}()}catch(e){}finally{setTimeout(()=>{X(!1)},500)}},[])),Xe=v.page>0&&v.page<v.totalPages,et=null===(t=Ve?.["yokoi/date-now"])||void 0===t||t,tt=(0,c.useCallback)(()=>{ce&&(v.page>=v.totalPages||$e({search:v.search,page:v.page+1,append:!0}))},[ce,v,$e]),ot=Ce;return ae?(0,g.jsxs)(c.Fragment,{children:[(0,g.jsx)(A,{target:"yokoi-settings-sidebar",icon:(0,g.jsx)(B,{}),children:(0,a.__)("Yokoi Settings","yokoi")}),(0,g.jsx)(z,{name:"yokoi-settings-sidebar",children:(0,g.jsx)(r.TabPanel,{initialTabName:"catalog",tabs:[{name:"catalog",title:(0,a.__)("Blocks","yokoi")},{name:"settings",title:(0,a.__)("Settings","yokoi")}],children:e=>"settings"===e.name?(0,g.jsx)(r.Card,{children:(0,g.jsx)(r.CardBody,{children:(0,g.jsxs)(r.Flex,{direction:"column",gap:4,children:[et&&(0,g.jsx)(r.TextControl,{label:(0,a.__)("Google Calendar API key","yokoi"),value:qe,onChange:Je,placeholder:(0,a.__)("Paste your Google API key","yokoi"),help:(0,a.__)("Create a Maps Platform project, enable Calendar API access, and paste the key here.","yokoi"),disabled:!Le||ot}),(0,g.jsxs)(r.Flex,{direction:"column",gap:2,children:[(0,g.jsx)(r.Button,{type:"button",variant:"secondary",onClick:e=>{e.preventDefault(),e.stopPropagation(),Ye()},disabled:ot,children:(0,a.__)("Export Settings","yokoi")}),(0,g.jsx)(r.Button,{type:"button",variant:"secondary",onClick:e=>{e.preventDefault(),e.stopPropagation(),Ze()},disabled:ot,children:(0,a.__)("Import Settings","yokoi")})]})]})})}):(0,g.jsx)(k,{error:i,searchValue:d,onSearchChange:h,searchHistory:N,hasMore:Xe,onLoadMore:tt,blocksEnabled:Ve,blockDefinitions:o,onToggle:We,onToggleAll:He,onToggleFavorite:Ke,favoriteBlocks:F,togglingBlocks:R,blockStatistics:W,validationErrors:H,disabled:ot||Q,onRefreshInserter:Qe,onRetry:()=>{u(null),$e({search:v.search,page:v.page||1,append:!1})}})})})]}):(0,g.jsxs)(c.Fragment,{children:[(0,g.jsx)(PluginSidebarMoreMenuItem,{target:"yokoi-settings-sidebar",icon:"admin-settings",children:(0,a.__)("Yokoi Settings","yokoi")}),(0,g.jsx)(PluginSidebar,{name:"yokoi-settings-sidebar",title:(0,a.__)("Yokoi Settings","yokoi"),icon:"admin-settings",children:(0,g.jsx)("div",{className:"yokoi-sidebar-content",children:(0,g.jsx)("p",{children:(0,a.__)("You do not have permission to manage Yokoi settings.","yokoi")})})})]})};d()(()=>{const e=window?.wp?.editor,t=window?.wp?.editSite,o=document?.body?.classList?.contains("site-editor-php")||document?.body?.classList?.contains("edit-site");if(!t||!o)return;const r=e?.PluginSidebar&&e?.PluginSidebarMoreMenuItem?e:t,{PluginSidebar:i,PluginSidebarMoreMenuItem:s}=r||{};i&&s&&(z=i,A=s,(0,n.registerPlugin)("yokoi-settings-sidebar",{render:M,icon:B}),(()=>{if(!(()=>{try{return"1"===new URLSearchParams(window.location.search).get("yokoi_sidebar")}catch(e){return!1}})())return;let e=5;const t=()=>{(()=>{const e=window?.wp?.data;if(!e?.dispatch)return;const t=e.dispatch("core/edit-site");if(t?.openGeneralSidebar)return void t.openGeneralSidebar(`edit-site/plugin-sidebar/${R}`);const o=e.dispatch("core/edit-post");o?.openGeneralSidebar&&o.openGeneralSidebar(`edit-post/plugin-sidebar/${R}`)})(),e-=1,e>0&&window.setTimeout(t,300)};window.setTimeout(t,150)})())})},9770:e=>{e.exports=function(e,t){for(var o=-1,n=null==e?0:e.length,r=0,i=[];++o<n;){var s=e[o];t(s,o,e)&&(i[r++]=s)}return i}},9817:e=>{e.exports=function(e){return this.__data__.has(e)}},9935:e=>{e.exports=function(){return!1}}},o={};function n(e){var r=o[e];if(void 0!==r)return r.exports;var i=o[e]={id:e,loaded:!1,exports:{}};return t[e](i,i.exports,n),i.loaded=!0,i.exports}n.m=t,e=[],n.O=(t,o,r,i)=>{if(!o){var s=1/0;for(u=0;u<e.length;u++){for(var[o,r,i]=e[u],a=!0,c=0;c<o.length;c++)(!1&i||s>=i)&&Object.keys(n.O).every(e=>n.O[e](o[c]))?o.splice(c--,1):(a=!1,i<s&&(s=i));if(a){e.splice(u--,1);var l=r();void 0!==l&&(t=l)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[o,r,i]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={61:0,118:0};n.O.j=t=>0===e[t];var t=(t,o)=>{var r,i,[s,a,c]=o,l=0;if(s.some(t=>0!==e[t])){for(r in a)n.o(a,r)&&(n.m[r]=a[r]);if(c)var u=c(n)}for(t&&t(o);l<s.length;l++)i=s[l],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(u)},o=globalThis.webpackChunkyokoi=globalThis.webpackChunkyokoi||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var r=n.O(void 0,[118],()=>n(9417));r=n.O(r)})();