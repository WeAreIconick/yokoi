(()=>{"use strict";var e,o={96:(e,o,s)=>{const a=window.wp.plugins,i=window.wp.components,n=window.wp.apiFetch;var t=s.n(n);const l=window.wp.i18n,r=window.wp.element,c=window.wp.domReady;var d=s.n(c);const u=window.wp.url,b=window.ReactJSXRuntime,g=({isLoading:e=!1,isLoadingMore:o=!1,error:s=null,searchValue:a="",onSearchChange:n=()=>{},blocksEnabled:t={},blockDefinitions:r={},onToggle:c,hasMore:d=!1,onLoadMore:u=()=>{}})=>{var g;const h=(Object.keys(r).length?Object.keys(r):Object.keys(t)).map(e=>{var o;return[e,null===(o=t?.[e])||void 0===o||o]}),_=null!==(g=a?.toLowerCase?.())&&void 0!==g?g:"",k=h.filter(([e])=>!_||`${r[e]?.title||e} ${r[e]?.description||""}`.toLowerCase().includes(_));return(0,b.jsx)(i.Panel,{children:(0,b.jsxs)(i.PanelBody,{title:(0,l.__)("Enable/Disable Blocks","yokoi"),initialOpen:!0,children:[(0,b.jsx)(i.SearchControl,{value:a,onChange:n,placeholder:(0,l.__)("Search blocks…","yokoi")}),e&&(0,b.jsx)(i.PanelRow,{className:"yokoi-sidebar__panel-row",children:(0,b.jsx)("p",{className:"yokoi-sidebar__loading-message",children:(0,l.__)("Loading block catalog…","yokoi")})}),s&&!e&&(0,b.jsx)(i.PanelRow,{className:"yokoi-sidebar__panel-row",children:(0,b.jsx)("p",{className:"yokoi-sidebar__error",children:s?.message||(0,l.__)("Unable to load block catalog.","yokoi")})}),0===h.length&&(0,b.jsx)(i.PanelRow,{className:"yokoi-sidebar__panel-row yokoi-sidebar__panel-row--empty",children:(0,b.jsx)("p",{className:"yokoi-sidebar__empty",children:(0,l.__)("No blocks registered yet. Blocks will appear here once available.","yokoi")})}),!e&&0===k.length&&h.length>0&&(0,b.jsx)(i.PanelRow,{className:"yokoi-sidebar__panel-row yokoi-sidebar__panel-row--empty",children:(0,b.jsx)("p",{className:"yokoi-sidebar__empty",children:(0,l.__)("No blocks match your search.","yokoi")})}),k.map(([e,o])=>{const s=r[e]?.title||e,a=r[e]?.description;return(0,b.jsx)(i.PanelRow,{className:"yokoi-sidebar__panel-row",children:(0,b.jsx)(i.ToggleControl,{label:s,checked:Boolean(o),onChange:()=>c(e),help:a,__nextHasNoMarginBottom:!0})},e)}),d&&!e&&(0,b.jsx)(i.PanelRow,{className:"yokoi-sidebar__panel-row yokoi-sidebar__panel-row--load-more",children:(0,b.jsx)(i.Button,{variant:"secondary",onClick:u,isBusy:o,disabled:o,children:o?(0,l.__)("Loading…","yokoi"):(0,l.__)("Load more blocks","yokoi")})})]})})},h=window.yokoiSettings||{},_=Array.isArray(h.blocks)?h.blocks:[],k=(e=[])=>e.reduce((e,o)=>(o?.name&&(e[o.name]=o),e),{}),p=(e,o)=>{const s=((e={})=>({blocks_enabled:Object.fromEntries(Object.keys(e).map(e=>[e,!0])),default_configs:{},visibility_controls:{}}))(o),a={...s,...e||{}};return a.blocks_enabled={...s.blocks_enabled,...e?.blocks_enabled||{}},Object.keys(o).forEach(e=>{"boolean"!=typeof a.blocks_enabled[e]&&(a.blocks_enabled[e]=Boolean(s.blocks_enabled[e]))}),a.default_configs={...s.default_configs,...e?.default_configs||{}},a.visibility_controls={...s.visibility_controls,...e?.visibility_controls||{}},a};h?.nonce&&t().use(t().createNonceMiddleware(h.nonce));let y=null,m=null;const w=(e={})=>(0,b.jsxs)("svg",{className:"yokoi-sidebar__icon",width:"20",height:"20",viewBox:"0 0 163.3 163.3",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",...e,children:[(0,b.jsx)("path",{d:"M145.1,38.5c0-1.2-.9-2.1-2.1-2.1H20.3c-1.2,0-2.1.9-2.1,2.1v104.4c0,1.2.9,2.1,2.1,2.1h122.7c1.2,0,2.1-.9,2.1-2.1V38.5ZM0,161.9V1.5C.6.5,1.8,0,3.5,0,51.6,0,98.1,0,143.1,0c1.2,0,2.1.9,2.1,2.1v13.9c0,1.2.9,2.1,2.1,2.2.6,0,5.2,0,13.9,0,1.4,0,2.1.8,2.1,2.4,0,3.5,0,50,0,139.5,0,2.2-.6,3.1-2.8,3.1-53,0-105.9,0-158.9,0,0,0-.2,0-.2,0l-1.4-1.3",fill:"currentColor"}),(0,b.jsx)("path",{d:"M75.2,86.9c0,1.2-.9,2.1-2.1,2.1h-8.8c-1.2,0-2.1-1-2.1-2.1v-18.2c0-1.2,1-2.1,2.1-2.1h8.8c1.2,0,2.1,1,2.1,2.1v18.2Z",fill:"currentColor"}),(0,b.jsx)("path",{d:"M101.1,86.9c0,1.2-.9,2.1-2.1,2.1h-8.8c-1.2,0-2.1-.9-2.1-2.1v-18.2c0-1.2.9-2.1,2.1-2.1h8.8c1.2,0,2.1.9,2.1,2.1v18.2Z",fill:"currentColor"}),(0,b.jsx)("path",{d:"M81.6,101.8c19.6,0,29.5,0,29.7,0,1.1,0,1.9-.9,1.9-2v-8.1c0-1.1.9-2,2-2h9c1.1,0,2,.9,2,2v8.9c0,1.1-.9,2.1-2.1,2.1h-8.2c-1.1,0-1.9.8-1.9,1.9v8.1c0,1.1-.9,1.9-1.9,2,0,0-10.2,0-30.5,0-20.3,0-30.5,0-30.5,0-1.1,0-1.9-1-1.9-2v-8.1c0-1-.9-1.9-2-1.9h-8.2c-1.1,0-2.1-.9-2.1-2.1v-8.9c0-1.1.9-2,2-2h9c1.1,0,2,.9,2,2v8.1c0,1.1.9,1.9,1.9,2,.2,0,10,0,29.7,0Z",fill:"currentColor"})]}),v=e=>e?"string"==typeof e?e:e?.message?e.message:(0,l.__)("An unexpected error occurred.","yokoi"):"",f=()=>{if(!y||!m)return null;const[e,o]=(0,r.useState)(()=>k(_)),[s,a]=(0,r.useState)(!1),[n,c]=(0,r.useState)(null),[d,f]=(0,r.useState)(""),[j,x]=(0,r.useState)(""),[S,P]=(0,r.useState)({page:0,totalPages:0,search:""}),[C,M]=(0,r.useState)(!1);(0,r.useEffect)(()=>{const e=setTimeout(()=>{x(d)},300);return()=>clearTimeout(e)},[d]);const N=(0,r.useCallback)((o,s=e)=>p(o,s),[e]),[O,L]=(0,r.useState)(p(h.settings,e)),[B,E]=(0,r.useState)(!h.settings),[T,R]=(0,r.useState)(!1),[A,Y]=(0,r.useState)(!1),[I,D]=(0,r.useState)(null),[V,Z]=(0,r.useState)(!1),F=!1!==h?.capabilities?.canManage,X=h?.restEndpoint,G=h?.blocksEndpoint,H=(0,r.useCallback)((o,s=e)=>N(o,s),[N,e]),W=(0,r.useCallback)(()=>{X&&F?(E(!0),t()({url:X,method:"GET"}).then(e=>{L(H(e)),Y(!1),V&&Z(!1),D(null)}).catch(e=>{D(e)}).finally(()=>{E(!1)})):E(!1)},[X,F,H,V]);(0,r.useEffect)(()=>{h.settings||W()},[W]),(0,r.useEffect)(()=>{G&&Q({search:j,page:1,append:!1})},[G,j,Q]);const $=(0,r.useMemo)(()=>O?.blocks_enabled||{},[O]),J=(0,r.useCallback)(e=>{L(o=>{const s={...o.blocks_enabled,[e]:!o.blocks_enabled?.[e]};return{...o,blocks_enabled:s}}),Y(!0)},[]),Q=(0,r.useCallback)(async({search:e="",page:s=1,append:i=!1}={})=>{if(G){c(null),i?M(!0):a(!0);try{const a=(0,u.addQueryArgs)(G,{per_page:100,page:s,...e?{search:e}:{}}),n=await t()({url:a,method:"GET",parse:!1}),l=await n.json();if(!n.ok)throw l;const r=parseInt(n.headers.get("X-WP-Total"),10)||l.length||0,c=parseInt(n.headers.get("X-WP-TotalPages"),10)||Math.max(1,Math.ceil(r/100)),d=k(Array.isArray(l)?l:[]);let b=d;o(e=>(b=i?{...e,...d}:d,b)),L(e=>p(e,b)),P({page:s,totalPages:c,search:e})}catch(o){c(o),i||P({page:0,totalPages:0,search:e})}finally{i?M(!1):a(!1)}}},[G]),U=S.page>0&&S.page<S.totalPages,q=(0,r.useCallback)(()=>{G&&(S.page>=S.totalPages||Q({search:S.search,page:S.page+1,append:!0}))},[G,S,Q]),z=(0,r.useCallback)(()=>{X&&(R(!0),D(null),t()({url:X,method:"POST",data:{blocks_enabled:O.blocks_enabled,default_configs:O.default_configs,visibility_controls:O.visibility_controls,nonce:h?.settingsNonce}}).then(e=>{const o=H(e?.data||e);L(o),Y(!1),Z(!0),setTimeout(()=>Z(!1),3e3)}).catch(e=>{D(e)}).finally(()=>{R(!1)}))},[X,O,H]);return F?(0,b.jsxs)(r.Fragment,{children:[(0,b.jsx)(m,{target:"yokoi-settings-sidebar",icon:(0,b.jsx)(w,{}),children:(0,l.__)("Yokoi Settings","yokoi")}),(0,b.jsxs)(y,{name:"yokoi-settings-sidebar",title:(0,l.__)("Yokoi Settings","yokoi"),icon:(0,b.jsx)(w,{}),children:[B&&(0,b.jsxs)("div",{className:"yokoi-sidebar__loading",children:[(0,b.jsx)(i.Spinner,{}),(0,b.jsx)("p",{children:(0,l.__)("Loading settings…","yokoi")})]}),V&&(0,b.jsx)(i.Notice,{status:"success",isDismissible:!1,children:(0,l.__)("Settings saved successfully.","yokoi")}),I&&(0,b.jsx)(i.Notice,{status:"error",onRemove:()=>D(null),children:v(I)}),(0,b.jsx)(g,{isLoading:s,isLoadingMore:C,error:n,searchValue:d,onSearchChange:f,hasMore:U,onLoadMore:q,blocksEnabled:$,blockDefinitions:e,onToggle:J}),(0,b.jsxs)("div",{className:"yokoi-sidebar__footer",children:[(0,b.jsx)(i.Button,{variant:"secondary",onClick:W,isBusy:B,disabled:T,children:(0,l.__)("Reset","yokoi")}),(0,b.jsx)(i.Button,{variant:"primary",onClick:z,isBusy:T,disabled:!A||T,children:T?(0,l.__)("Saving…","yokoi"):(0,l.__)("Save Settings","yokoi")})]})]})]}):(0,b.jsxs)(r.Fragment,{children:[(0,b.jsx)(PluginSidebarMoreMenuItem,{target:"yokoi-settings-sidebar",icon:"admin-settings",children:(0,l.__)("Yokoi Settings","yokoi")}),(0,b.jsx)(PluginSidebar,{name:"yokoi-settings-sidebar",title:(0,l.__)("Yokoi Settings","yokoi"),icon:"admin-settings",children:(0,b.jsx)("p",{children:(0,l.__)("You do not have permission to manage Yokoi settings.","yokoi")})})]})};d()(()=>{const e=window?.wp?.editor,o=window?.wp?.editSite,s=document?.body?.classList?.contains("site-editor-php")||document?.body?.classList?.contains("edit-site");if(!o||!s)return;const i=e?.PluginSidebar&&e?.PluginSidebarMoreMenuItem?e:o,{PluginSidebar:n,PluginSidebarMoreMenuItem:t}=i||{};n&&t&&(y=n,m=t,(0,a.registerPlugin)("yokoi-settings-sidebar",{render:f,icon:w}))})}},s={};function a(e){var i=s[e];if(void 0!==i)return i.exports;var n=s[e]={exports:{}};return o[e](n,n.exports,a),n.exports}a.m=o,e=[],a.O=(o,s,i,n)=>{if(!s){var t=1/0;for(d=0;d<e.length;d++){for(var[s,i,n]=e[d],l=!0,r=0;r<s.length;r++)(!1&n||t>=n)&&Object.keys(a.O).every(e=>a.O[e](s[r]))?s.splice(r--,1):(l=!1,n<t&&(t=n));if(l){e.splice(d--,1);var c=i();void 0!==c&&(o=c)}}return o}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[s,i,n]},a.n=e=>{var o=e&&e.__esModule?()=>e.default:()=>e;return a.d(o,{a:o}),o},a.d=(e,o)=>{for(var s in o)a.o(o,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:o[s]})},a.o=(e,o)=>Object.prototype.hasOwnProperty.call(e,o),(()=>{var e={61:0,118:0};a.O.j=o=>0===e[o];var o=(o,s)=>{var i,n,[t,l,r]=s,c=0;if(t.some(o=>0!==e[o])){for(i in l)a.o(l,i)&&(a.m[i]=l[i]);if(r)var d=r(a)}for(o&&o(s);c<t.length;c++)n=t[c],a.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return a.O(d)},s=globalThis.webpackChunkyokoi=globalThis.webpackChunkyokoi||[];s.forEach(o.bind(null,0)),s.push=o.bind(null,s.push.bind(s))})();var i=a.O(void 0,[118],()=>a(96));i=a.O(i)})();