(()=>{"use strict";const e=new Set(["Enter"," "]),t=e=>"true"===String(e),n=e=>{if("string"!=typeof e)return"";const t=document.createElement("div");return t.textContent=e,t.innerHTML},r=(e,t,r)=>{const a=e.querySelector(".card-image"),o=n(t[`${r}ImageUrl`]),i=n(t[`${r}ImageAlt`]);if(o)if(a){const e=a.querySelector("img");e&&(e.src=o,e.alt=i)}else{const t=document.createElement("div");t.className="card-image";const n=document.createElement("img");n.src=o,n.alt=i,t.appendChild(n),e.insertBefore(t,e.firstChild)}else a&&a.remove()},a=(e,t)=>{e&&(e.textContent=n(t))},o=(e,t,n,r)=>{const a=`Card ${t+1} of ${n}. ${r?"Back side – click to show front":"Front side – click to show back"}`;e.setAttribute("aria-label",a),e.setAttribute("aria-pressed",r?"true":"false")},i=n=>{const i=(e=>{if(!e)return[];try{const t=JSON.parse(e.dataset.cards||"[]");return Array.isArray(t)?t:[]}catch(e){return[]}})(n);if(!i.length)return;const s=n.querySelector(".flip-card"),c=s?.querySelector(".flip-card-inner"),d=s?.querySelector(".flip-card-front .flip-card-content"),l=s?.querySelector(".flip-card-back .flip-card-content"),u=d?.querySelector("h3"),f=d?.querySelector("p"),v=l?.querySelector("h3"),y=l?.querySelector("p"),p=n.querySelector(".carousel-nav.prev"),h=n.querySelector(".carousel-nav.next"),w=n.querySelectorAll(".carousel-indicators .indicator");if(!s||!c)return;const g=t(n.dataset.showNavigation),k=t(n.dataset.showIndicators),m=t(n.dataset.autoPlay),b=parseInt(n.dataset.autoPlayDelay||"5000",10);let E=0,L=!1,A=!1,S=null;const q=(e,t=!1)=>{if(!i[e]||A)return;const n=i[e];A=!0,t&&s.classList.add("changing"),a(u,n.frontTitle),a(f,n.frontContent),a(v,n.backTitle),a(y,n.backContent),d&&r(d,n,"front"),l&&r(l,n,"back"),k&&((e,t)=>{e.forEach((e,n)=>{const r=n===t;e.classList.toggle("active",r),e.setAttribute("aria-pressed",r?"true":"false")})})(w,e),L&&(c.style.transform="rotateY(0deg)",L=!1),o(s,e,i.length,L),((e,t,n,r)=>{if(e){const t=0===n?r:n;e.setAttribute("aria-label",`Go to card ${t}`)}if(t){const e=n===r-1?1:n+2;t.setAttribute("aria-label",`Go to card ${e}`)}})(p,h,e,i.length),setTimeout(()=>{s.classList.remove("changing"),A=!1},t?300:0)},D=e=>{e!==E&&(E=(e+i.length)%i.length,q(E,!0),N())},C=()=>D(E+1),I=()=>D(E-1),$=()=>{A||(L=!L,c.style.transform=L?"rotateY(180deg)":"rotateY(0deg)",o(s,E,i.length,L),T())},x=()=>{!m||i.length<2||(S&&clearInterval(S),S=window.setInterval(C,b))},T=()=>{S&&(clearInterval(S),S=null)},N=()=>{T(),x()},Y=t=>n=>{("keydown"!==n.type||e.has(n.key))&&(n.preventDefault(),D(t))},B=()=>{document.hidden?T():x()};q(E),s.setAttribute("role","button"),s.setAttribute("tabindex","0"),s.addEventListener("keydown",t=>{e.has(t.key)&&(t.preventDefault(),$())}),s.addEventListener("click",e=>{("ontouchstart"in window||1===i.length)&&(e.preventDefault(),$())}),s.addEventListener("touchstart",e=>{e.preventDefault(),$()},{passive:!1}),g&&p&&h&&(p.addEventListener("click",e=>{e.preventDefault(),I()}),p.addEventListener("keydown",Y(-1)),h.addEventListener("click",e=>{e.preventDefault(),C()}),h.addEventListener("keydown",Y(1))),k&&w.forEach((e,t)=>{e.setAttribute("role","button"),e.setAttribute("tabindex","0"),e.addEventListener("click",Y(t)),e.addEventListener("keydown",Y(t))}),n.addEventListener("keydown",e=>{switch(e.key){case"ArrowLeft":e.preventDefault(),I();break;case"ArrowRight":e.preventDefault(),C();break;case"Home":e.preventDefault(),D(0);break;case"End":e.preventDefault(),D(i.length-1)}}),n.addEventListener("mouseenter",T),n.addEventListener("mouseleave",x),n.addEventListener("focusin",T),n.addEventListener("focusout",x),document.addEventListener("visibilitychange",B),x(),n.addEventListener("yokoi:flip-side:cleanup",()=>{T(),document.removeEventListener("visibilitychange",B)})},s=()=>{const e=document.querySelectorAll(".wp-block-yokoi-flip-side");e.length&&e.forEach(i)};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",s):s(),"undefined"!=typeof window&&window.wp&&window.wp.hooks&&"function"==typeof window.wp.hooks.addAction&&window.wp.hooks.addAction("yokoi.flip-side.init","yokoi/flip-side",s)})();