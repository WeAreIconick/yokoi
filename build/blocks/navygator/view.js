!function(){"use strict";function t(t){if(!t||"string"!=typeof t)return null;const n=t.replace(/[^a-zA-Z0-9_-]/g,"");return n&&n.length<=100?n:null}function n(){let n=null;const i=document.querySelector(".wp-block-yokoi-navygator");if(n=i&&document.body.contains(i)?i.querySelector(".navygator-toc-wrapper"):document.querySelector(".navygator-toc-wrapper"),!n||!document.body.contains(n))return;const s=n.querySelector(".navygator-toc"),r=n.querySelector(".navygator-toc-toggle"),c=n.querySelector(".navygator-toc-close"),a=n.querySelector(".navygator-toc-backdrop"),u=Array.from(n.querySelectorAll(".navygator-toc-link"));let l=window.innerWidth<=768;const d=function(t){let n;return function(...e){n||(t.apply(this,e),n=!0,setTimeout(()=>n=!1,150))}}(()=>{l=window.innerWidth<=768});function f(){s&&s.classList.remove("is-open"),a&&a.classList.remove("is-visible"),document.body.classList.remove("navygator-toc-open")}function p(){s&&s.classList.remove("is-open")}window.addEventListener("resize",d,{passive:!0}),r&&r.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation(),l?(s&&s.classList.add("is-open"),a&&a.classList.add("is-visible"),document.body.classList.add("navygator-toc-open")):s&&(s.classList.contains("is-open")?p():s&&s.classList.add("is-open"))},{passive:!1}),c&&c.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation(),l?f():p()},{passive:!1}),a&&a.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation(),f()},{passive:!1}),document.addEventListener("keydown",t=>{"Escape"===t.key&&s&&s.classList.contains("is-open")&&(l?f():p())},{passive:!0}),u.forEach(function(n){n.addEventListener("click",function(n){n.preventDefault();const e=this.getAttribute("href");if(!e||!e.startsWith("#"))return;const o=t(e.substring(1));if(!o)return;const i=document.getElementById(o);i&&document.body.contains(i)&&(l?f():p(),requestAnimationFrame(()=>{const t=i.getBoundingClientRect().top+window.pageYOffset+-20;if(window.scrollTo({top:Math.max(0,t),behavior:"smooth"}),history&&history.pushState)try{history.pushState(null,"","#"+encodeURIComponent(o))}catch(t){}}))},{passive:!1})}),u.length>0&&function(n,i){const s=n.map(function(n){const e=n.getAttribute("href");return e&&e.startsWith("#")?t(e.substring(1)):null}).filter(function(t){return null!==t});if(0===s.length)return;const r=s.map(function(t){const n=document.getElementById(t);return n&&document.body.contains(n)?n:null}).filter(function(t){return null!==t});if(0===r.length)return;let c=null;const a=new IntersectionObserver(function(s){c&&cancelAnimationFrame(c),c=requestAnimationFrame(function(){s.forEach(function(s){if(s.isIntersecting){const r=t(s.target.id);r&&(e(r,n),o(r,n,i))}})})},{rootMargin:"-20% 0px -35% 0px",threshold:0});r.forEach(function(t){document.body.contains(t)&&a.observe(t)});const u=function(n){if(!n||0===n.length)return null;const e=window.scrollY+100;for(let o=n.length-1;o>=0;o--){const i=n[o];if(i&&document.body.contains(i)&&i.offsetTop<=e)return t(i.id)}return n[0]&&document.body.contains(n[0])?t(n[0].id):null}(r);u&&(e(u,n),o(u,n,i)),window.addEventListener("beforeunload",function(){c&&cancelAnimationFrame(c),a.disconnect()},{passive:!0})}(u,n)}function e(n,e){n&&e.forEach(function(e){const o=e.getAttribute("href");if(!o||!o.startsWith("#"))return;const i=t(o.substring(1));i&&(i===n?e.classList.add("is-active"):e.classList.remove("is-active"))})}function o(n,e,o){if(!n||!o)return;const i=e.find(function(e){const o=e.getAttribute("href");return!(!o||!o.startsWith("#"))&&t(o.substring(1))===n});if(!i||!document.body.contains(i))return;const s=o.querySelector(".navygator-toc");s&&document.body.contains(s)&&requestAnimationFrame(function(){const t=s.getBoundingClientRect(),n=i.getBoundingClientRect(),e=n.top-t.top,o=n.bottom-t.top,r=t.height;if(e<0||o>r){const t=i.offsetTop-r/2+n.height/2;s.scrollTo({top:Math.max(0,t),behavior:"smooth"})}})}window.navygatorInitialized||(window.navygatorInitialized=!0,"loading"===document.readyState?document.addEventListener("DOMContentLoaded",n):n())}();