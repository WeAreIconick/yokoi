!function(){"use strict";if(window.yokoiLogoParadeInitialized)return;window.yokoiLogoParadeInitialized=!0;const t=t=>{if("string"!=typeof t)return"";const i=document.createElement("div");return i.textContent=t,i.textContent||""},i=(t,i,e,s)=>{const n=parseInt(t,10);return isNaN(n)?i:Math.max(e,Math.min(s,n))};class e{constructor(e){this.carousel=e,this.track=null,this.allItems=[],this.originalItems=[],this.currentIndex=0,this.intervalId=null,this.isTransitioning=!1,this.itemWidth=0,this.gap=0,this.animationFrameId=null,this.observer=null,this.isVisible=!1,this.direction=1,this.rotationSpeed=i(e.dataset.rotationSpeed,3e3,1e3,1e4),this.transitionDuration=i(e.dataset.transitionDuration,500,200,2e3),this.pauseOnHover="false"!==e.dataset.pauseOnHover&&"0"!==e.dataset.pauseOnHover,this.autoPlay="false"!==e.dataset.autoPlay&&"0"!==e.dataset.autoPlay,this.animationDirection=t(e.dataset.animationDirection||"left"),this.animationType=t(e.dataset.animationType||"continuous"),this.originalCount=i(e.dataset.originalCount,0,1,1e3),this.prefersReducedMotion=window.matchMedia("(prefers-reduced-motion: reduce)").matches,this.init()}init(){if(this.track=this.carousel.querySelector(".logo-parade-track"),!this.track)return;const t=this.track.querySelectorAll(".logo-parade-item");this.allItems=Array.from(t),this.originalItems=this.allItems.filter(t=>!t.hasAttribute("aria-hidden")),this.allItems.length<=1||this.originalItems.length<=1||this.prefersReducedMotion||!this.autoPlay||(this.setupIntersectionObserver(),this.setupResizeHandler(),this.setupVisibilityHandler(),this.pauseOnHover&&this.setupHoverHandlers())}setupIntersectionObserver(){!1 in window?this.startAnimation():(this.observer=new IntersectionObserver(t=>{t.forEach(t=>{t.target===this.carousel&&(this.isVisible=t.isIntersecting,this.isVisible?this.startAnimation():this.stopAnimation())})},{rootMargin:"50px",threshold:.01}),this.observer.observe(this.carousel))}setupResizeHandler(){const t=(t=>{let i;return function(...e){clearTimeout(i),i=setTimeout(()=>{clearTimeout(i),t(...e)},200)}})(()=>{this.stopAnimation(),this.recalculateMetrics(),this.resetCarousel(),this.isVisible&&this.startAnimation()});window.addEventListener("resize",t,{passive:!0})}setupVisibilityHandler(){document.addEventListener("visibilitychange",()=>{document.hidden?this.stopAnimation():this.isVisible&&this.startAnimation()},{passive:!0})}setupHoverHandlers(){this.carousel.addEventListener("mouseenter",()=>{this.stopAnimation()},{passive:!0}),this.carousel.addEventListener("mouseleave",()=>{this.isVisible&&this.startAnimation()},{passive:!0})}recalculateMetrics(){const t=this.allItems[0];t&&(this.animationFrameId&&cancelAnimationFrame(this.animationFrameId),this.animationFrameId=requestAnimationFrame(()=>{const i=t.getBoundingClientRect();this.itemWidth=i.width||0;const e=window.getComputedStyle(this.track).gap||"0px";this.gap=parseFloat(e)||40}))}moveToIndex(t,i=!1){if(this.itemWidth<=0||!this.track)return;const e=-t*(this.itemWidth+this.gap);this.track.style.transition=i?"none":`transform ${this.transitionDuration}ms ease-in-out`,this.track.style.transform=`translate3d(${e}px, 0, 0)`,i&&this.track.offsetHeight}resetCarousel(){this.currentIndex=0,this.direction=1,this.moveToIndex(0,!0)}nextSlide(){if(this.isTransitioning||this.itemWidth<=0)return;this.isTransitioning=!0,"bidirectional"===this.animationDirection?((this.currentIndex>=this.originalCount-1||this.currentIndex<=0)&&(this.direction*=-1),this.currentIndex+=this.direction):"right"===this.animationDirection?(this.currentIndex-=1,this.currentIndex<0&&(this.currentIndex=this.originalCount-1)):this.currentIndex+=1;const t=this.allItems[0];if(t){const i=t.getBoundingClientRect().width;Math.abs(i-this.itemWidth)>1&&(this.itemWidth=i)}this.moveToIndex(this.currentIndex),window.setTimeout(()=>{this.currentIndex>=this.originalCount&&this.resetCarousel(),this.isTransitioning=!1},this.transitionDuration)}stopAnimation(){this.intervalId&&(window.clearInterval(this.intervalId),this.intervalId=null)}startAnimation(){this.stopAnimation(),this.originalCount>1&&this.autoPlay&&(this.recalculateMetrics(),this.intervalId=window.setInterval(()=>{this.nextSlide()},this.rotationSpeed))}destroy(){this.stopAnimation(),this.observer&&this.observer.disconnect(),this.animationFrameId&&cancelAnimationFrame(this.animationFrameId)}}const s=()=>{const t=document.querySelectorAll(".wp-block-yokoi-logo-parade");if(!t.length)return;const i=[];t.forEach(t=>{try{const s=new e(t);i.push(s)}catch(t){}}),window.addEventListener("beforeunload",()=>{i.forEach(t=>{t.destroy()})})};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",s):s()}();